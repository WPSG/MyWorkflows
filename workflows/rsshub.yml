on:
  rsshub:
    path:
      - path: /douban/group/698716
        query:  &saleQuery
          filter_case_sensitive: false
          filter_title: 罐头|狗粮|爱肯拿|渴望|姐妹们快|牛奶|牛肉|羊肉|来伊份岩烧|来伊份面包|烤箱|生鲜|螺蛳粉|米诺|果酸|杏仁酸|鸡蛋|大米|薅|cr海盐|洗头膏|崔娅蓬松|洗鼻|橙|手机|K30s|摩托罗拉
      - path: /douban/group/657658
        query:
          filter_case_sensitive: false
          filter_title: 爱肯拿|狗粮|优惠|奶|罐头|k9|巅峰|福来恩|zeal
          filterout_title: 求|转|求购|交流|已购|专楼|蒙牛|伊利|闲置|出|讨论|华为|开车|停车|代拍|完|分装|意向|拼单|删
      - path: /telegram/channel/NewlearnerChannel
        query:
          filter_case_sensitive: false
      # - /telegram/channel/TGgeek
      # - /ncm/artist/74613
      # - /weibo/user/7319628020
      # - /weibo/user/6136032379
      # - /weibo/user/7125193035
      # - /bilibili/live/room/4580389
      # - /bilibili/live/room/545156
      # - /telegram/channel/nCoV2019
      # - /ncm/playlist/2345862215
      # - /ncm/user/playlist/488860927
      # - /zhihu/people/activities/fang-fang-75-69-92
      # - /bilibili/user/dynamic/474937176
    config:
      skipFirst: true
      format: |
        if (item.description) {
          item.description = item.description.replace(/<[^>]*>/g, "")
          if (item.description) {
            item.description = item.description.trim()
            if (item.description.length > 120) {
              item.description = `${item.description.substring(0, 120)}...`
            }
          }
        }
        if (item.title) {
          item.title = item.title.replace(/\[来自.+\]/g, "")
        }
        return item
jobs:
  rsshub:
    name: RssHub to Telegram Bot
    runs-on: ubuntu-latest
    steps:
      - name: Send a telegram message
        uses: appleboy/telegram-action@v0.1.0
        with:
          to: ${{ secrets.TELEGRAM_TO }}
          token: ${{ secrets.TG_BOT_FOR_RSS }}
          message: |
            <b>${{ on.rsshub.outputs.__channel_title }}</b>
            ${{ on.rsshub.outputs.title }}
            <a href="${{on.rsshub.outputs.link}}">${{on.rsshub.outputs.description}}</a>
          format: html
          disable_web_page_preview: true